---
- hosts: all
  gather_facts: no
  tasks:
    - name: Check if App is properly installed
      stat:
        path: "/tmp/myapp/current"
      register: app_root
      failed_when: not (app_root.stat.islnk is defined and app_root.stat.islnk)

    - name: Check if App is a git repo
      stat:
        path: "/tmp/myapp/current/.git"
      register: app_repo
      failed_when: not (app_repo.stat.isdir is defined and app_repo.stat.isdir)
